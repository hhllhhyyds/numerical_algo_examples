# 插值

## 多项式插值

* 拉格朗日插值法
* 牛顿差商法

## 插值的主要作用

* 多项式插值用简单的多项式计算替代其他复杂的函数计算，减少了计算量
* 用插值点信息来编码函数的信息，起到信息压缩的作用（虽然会损失信息）

## 插值误差

* 多项式插值误差
  
    对一个 $n$ 次可微的函数 $f(x)$, 取其上 $n$ 个点 $(x_1, f(x_1))...(x_n, f(x_n))$, 进行多项式插值，获得插值多项式 $P_{n-1}(x)$, 那么 $f(x)$ 与 $P_{n-1}(x)$ 之间的误差关系为

    $$f(x) = P_{n-1}(x) + \frac{f^{(n)}(c)}{n!}(x - x_1)\cdots (x - x_n)$$

    其中 $c$ 的取值与 $x$ 有关，且 $c$ 落在 $\{x_1, x_2, ..., x_n, x\}$ 这 $n + 1$ 个点可围成的最大的区间内.

    证明：
    过 $\{x_1, x_2, ..., x_n, x\}$ 这 $n + 1$ 个点的插值多项式为 $P_{n}(t)$, 有

    $$P_n(t) = P_{n-1}(t) + f[x_1\ ...\ x_n\ x](t-x_1)\cdots(t-x_n)$$

    在点 $x$ 上有

    $$f(x) = P_n(x) = P_{n-1}(x) + f[x_1\ ...\ x_n\ x](x-x_1)\cdots(x-x_n)$$

    定义 $g(t) = f(t) - P_{n-1}(t) - f[x_1\ ...\ x_n\ x](t-x_1)\cdots(t-x_n)$

    $g(t)$ 有 $\{x_1, x_2, ..., x_n, x\}$ 这 $n + 1$ 个零点，根据罗尔定理，这 $n + 1$ 个点可围成的最大的区间内必有一个点 $c$ 满足 

    $$g^{(n)}(c) = 0 = f^{(n)}(c) - n!f[x_1\ ...\ x_n\ x]$$

    所以

    $$f(x) = P_{n-1}(x) + f[x_1\ ...\ x_n\ x](x-x_1)\cdots(x-x_n) = \\ P_{n-1}(x) + \frac{f^{(n)}(c)}{n!}(x - x_1)\cdots (x - x_n)$$

## 插值点的选择

* 区间内均匀取点
    容易出现 Runge 效应，即区间边缘及区间外的插值误差特别大

* 分析误差项的形式，为了减小最大插值误差，给出切比雪夫插值点选取方法

### 切比雪夫插值

考虑确定一组 $n$ 个实数 $-1 \leq x_1,...,x_n \leq 1$ 使得 $\underset{-1 \leq x \leq 1}{max} |(x - x_1)\cdots (x - x_n)|$ 最小，这一组实数应该取为

$$x_i = cos\frac{(2i - 1)\pi}{2n},\ i = 1,...,n$$

此时 $\underset{-1 \leq x \leq 1}{max} |(x - x_1)\cdots (x - x_n)|$ 取得最小值为 $1/2^{n - 1}$

$$T_n(x) = 2^{n - 1} \cdot (x - x_1)\cdots (x - x_n),\ x_i = cos\frac{(2i - 1)\pi}{2n}$$

称为**切比雪夫多项式**。

使用切比雪夫多项式的根为插值点横坐标的插值多项式为**切比雪夫插值多项式**，相比于均匀采样后的插值，切比雪夫采样的多项式插值在插值范围内的最大误差明显减小

#### 切比雪夫多项式的性质

1. $T_n(x) = cos(n\ arccos\ x), -1 \leq x \leq 1, -1 \leq T_n(x) \leq 1$
2. $T_{n+1}(x) = 2xT_n(x) - T_{n - 1}(x)$
3. 由 2 可得切比雪夫多项式是多项式函数
4. 切比雪夫多项式 $T_n$ 的最高次数是 $n$,最高次项的系数是 $2^{n - 1}$
5. $T_n(1) = 1,\ T_n(-1) = (-1)^n$
6. $T_n(x) 有 n 个根，x_i = cos\frac{(2i - 1)\pi}{2n},\ i = 1,...,n$
7. $T_n(x)$ 在 $-1 \leq x \leq 1$ 间有 $n + 1$ 次取到 $1$ 或 $-1$
   
#### 切比雪夫插值误差最小的证明

现在要证明 $\underset{-1 \leq x \leq 1}{max} |(x - x_1)\cdots (x - x_n)|$ 取最小时即为 $T_n(x)/2^{n - 1} = (x - x_1)\cdots (x - x_n)$

用反证法，假设存在另一组 $P_n(x) = (x - x'_1)\cdots (x - x'_n)$ 使得 $|P_n(x)| < 1/2^{n-1}$, 由上述性质 7 可得， $P_n(x) - T_n(x)/2^{n - 1}$ 有 $n + 1$ 个零点，但 $P_n(x) - T_n(x)/2^{n - 1}$ 的最高次数最大只能是 $n - 1$, 因此最多只有 $n$ 个零点，所以矛盾
   
#### 任意区间的切比雪夫插值点

在区间 $[a, b]$ 内，切比雪夫插值点为

$$x_i = \frac{a + b}{2} + \frac{b - a}{2} cos\frac{(2i - 1)\pi}{2n}, i = 1, ..., n$$

这组插值点满足：在区间 $[a, b]$ 内

$$|(x - x_1)\cdots (x - x_n)| \leq \frac{(\frac{b - a}{2})^n}{2^{n - 1}}$$

## 样条插值

多项式插值使用单个全区间函数来经过所有样本点，而样条插值在分段区间使用分段函数来经过样本点

* 三次样条
    三次样条通过在相邻两个样本点之间定义一段三次的多项式函数来插值。并且满足相邻插值函数在插值点的导数相等，从而使插值曲线足够光滑

    定义好边界条件后，可通过求解一个稀疏矩阵来求出所有插值函数的系数

* 贝塞尔曲线
    $n$ 阶贝塞尔曲线的递归定义

    给定 k 个控制点 $P_i,\ i = 0,1,...,k - 1$, $k$ 阶贝塞尔曲线

    $$B_{P_0P_1...P_{k - 1}} = (1 - t)B_{P_0...P_{k - 2}} + t B_{P_1...P_{k - 1}}$$

    $k = 0,\ B_{P_0} = P_0$\
    $k = 1,\ B_{P_0P_1} = (1 - t)P_0 + t P_1$\
    $\begin{aligned}
    k = 2,\ B_{P_0P_1P_2} &= (1 - t)B_{P_0P_1} + t B_{P_1P_2}\\
    &= (1 - t)((1 - t)P_0 + t P_1) + t((1 - t)P_1 + t P_2)\\
    &= P_0 + (-2 P_0 + 2 P_1) t + (P_0 - 2 P_1 + P_2) t^2
    \end{aligned}$\
    $\begin{aligned}
    k = 3,\ B_{P_0P_1P_2P_3} &= (1 - t)B_{P_0P_1P_2} + t B_{P_1P_2P_3}\\
    &= P_0 + (-3 P_0 + 3 P_1) t + (3 P_0 - 6 P_1 + 3 P_2) t^2 \\&+ (-P_0 + 3 P_1 - 
        3 P_2 + P_3) t^3
    \end{aligned}$

    贝塞尔插值曲线适用于曲线存在弯折的情况，比如定义字体
