# 数值积分

### 核心思想

选取被积函数的一些点，用容易积分的函数去插值或拟合这些点，然后对插值函数或拟合函数进行积分。

### Romberg 积分

通过增加新的精细的点来不断增加精确度的积分方式。一种迭代性的积分方式。迭代截止条件一般为，两次迭代取得的积分值之差小于某个阈值。

### 适应性积分

函数变化快的区域需要更精细地划分积分点，函数变化缓慢的区域可以少取点。这一事实导致了适应性积分算法的出现。

核心思想是通过查看两点积分和三点积分的差值来估计该步的积分误差，若误差还是大于阈值，则继续细分并递归积分

### 高斯积分

积分选取的数据点不一定是等间距的。高斯积分选择勒朗德多项式的根作为采样点，精度更高。

区间 $[a,b]$ 上的一组非零正交函数 $\{ p_0,...,p_n \}$ 满足

$$\int_a^b p_j(x)p_k(x)dx  \begin{cases}=0, j\neq k\\ \neq 0, j=k\end{cases}$$

如果区间 $[a,b]$ 上的一组非零正交函数 $\{ p_0,...,p_n \}$ 同时满足 $p_i$ 的阶数（最高次项的次数）为 $i$, 则这组函数是阶数不超过 $n$ 的多项式函数组成的线性空间的一组基底，且函数 $p_i$ 在区间 $(a,b)$ 上有 $i$ 个不同的根

* 勒朗德多项式

勒让德多项式 
$$p_i(x) = \frac{1}{2^i i!}\frac{d^i}{dx^i}[(x^2-1)^i], i=0,1,...,n$$
是区间 $[-1,1]$ 上的一组正交基函数

设 $n$ 阶勒让德多项式在 $[-1, 1]$ 上的 $n$ 个不同的根为 $x_1, x_2,...,x_n$, 根据拉格朗日插值公式，这 $n$ 个采样点上对 $f(x)$ 得到的插值多项式函数为

$$Q(x) =\sum_{i = 1}^n L_i(x)f(x_i) = \sum_{i = 1}^n f(x_i) \frac{\prod_{j = 1,i \neq j}^n (x - x_j)}{\prod_{j = 1,i \neq j}^n (x_i - x_j)}$$

于是高斯积分为

$$\int_{-1}^1 f(x)dx \approx \int_{-1}^1 Q(x)dx = \sum_{i = 1}^n f(x_i)\int_{-1}^1 L_i(x)dx $$

其中 $x_i, \int_{-1}^1 L_i(x)dx$ 都可以通过查表获得精确值